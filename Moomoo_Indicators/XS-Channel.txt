{------------------------------------
1. 典型价格 & 长期通道基线
------------------------------------}
TYPICAL_PRICE := (2*CLOSE + HIGH + LOW) / 4;
AA := MA(TYPICAL_PRICE, 5);

{------------------------------------
2. 长期通道（外侧）
------------------------------------}
CH1 := AA * N / 100;
CH2 := AA * (200 - N) / 100;

{------------------------------------
3. 短期通道波动率（DMA 权重）
------------------------------------}
MA20_CLOSE := MA(CLOSE, 20);
CC := ABS(TYPICAL_PRICE - MA20_CLOSE) / MA20_CLOSE;



ALPHA := MIN(MAX(CC, 0), 1);

{------------------------------------
4. 动态移动平均 DD（DMA）
------------------------------------}
DD := DMA(CLOSE, ALPHA);

{------------------------------------
5. 短期通道（内侧）
------------------------------------}
CH3 := DD * (1 + M / 100);
CH4 := DD * (1 - M / 100);

{------------------------------------
6. 输出（⚠️ 输出名 ≠ 计算名）
------------------------------------}
CHANNEL1:CH1,COLORFFA500,LINETHICK2;   {短期上轨}
CHANNEL2:CH2,COLOR006400,LINETHICK2;   {短期下轨}
CHANNEL3:CH3,COLORFF0000,LINETHICK2;   {长期上轨}
CHANNEL4:CH4,COLOR0000FF,LINETHICK2;   {长期下轨}
